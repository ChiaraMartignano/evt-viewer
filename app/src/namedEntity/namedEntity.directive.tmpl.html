<span class="namedEntity namedEntity-{{ ::vm.entityType }}" 
    ng-switch="vm.entityType">
	<span class="namedEntity__header" ng-switch="::vm.entityType" ng-click="vm.toggle()">
        <i class="fa"
            ng-class="{ 
                'fa-caret-down' : vm.opened,
                'fa-caret-right': !vm.opened }"></i>
        <span ng-switch-when="place">
            <span ng-if="::vm.entity.settlement" 
                ng-repeat="settlement in ::vm.entity.settlement">
                {{::settlement.textContent}}<span ng-if="::settlement.attributes.type">, {{::settlement.attributes.type}}</span>
            </span>
        </span>

        <span ng-switch-when="person">
    		<span ng-if="::vm.entity.name">
    			{{::vm.entity.name.textContent}}
    		</span>
            <span ng-if="::vm.entity.forename">
                {{::vm.entity.forename.textContent}}
            </span>
            <span ng-if="::vm.entity.surname">
                {{::vm.entity.surname.textContent}}
            </span>
        </span>

        <span ng-switch-when="org">
            <span ng-if="::vm.entity.orgName" 
                ng-repeat="orgName in ::vm.entity.orgName">
                {{::orgName.textContent}}<span ng-if="::orgName.attributes.type">, {{::orgName.attributes.type}}</span>
            </span>
        </span>

        <span ng-switch-default>
            {{ ::vm.entity.label }}
        </span>
    </span>

    <span class="namedEntity__details" ng-if="vm.opened">
        <span class="namedEntity__moreInfo-toggler" ng-click="vm.toggleMoreInfo()">
            <i class="fa"
                ng-class="{ 
                    'fa-caret-down' : vm.moreInfoOpened,
                    'fa-caret-right': !vm.moreInfoOpened }"></i>
            About
        </span>
        <span class="namedEntity__moreInfo" 
            ng-class="{'opened': vm.moreInfoOpened }">
            
            <span ng-if="::vm.entity.notes && vm.entity.notes.length > 0" 
                class="{{ note.type }}"
                ng-repeat="note in ::vm.entity.notes"
                compile="::note.content">
            </span>

            <span ng-if="::vm.entity.desc" 
                ng-repeat="desc in ::vm.entity.desc"
                compile="::desc.content">
            </span>

            <span ng-if="::vm.entity.details" 
                compile="::vm.entity.details">
            </span>            

            <span ng-if="::vm.noMoreInfo">
                No more information available.
            </span>

            <span ng-switch="::vm.entityType">
                <span ng-switch-when="place">
                </span>

                <span ng-switch-when="person">
                </span>

                <span ng-switch-when="org">
                </span>

                <span ng-switch-default>
                </span>        
            </span>

        </span>

        <span class="namedEntity__occurrences-toggler" ng-click="vm.toggleOccurrences()">
            <i class="fa"
                ng-class="{ 
                    'fa-caret-down' : vm.occurrencesOpened,
                    'fa-caret-right': !vm.occurrencesOpened }"></i>
                Occurrences
        </span>
        <span class="namedEntity__occurrences"
            ng-class="{'opened': vm.occurrencesOpened }">
            
            <span ng-if="::vm.occurrences && vm.occurrences.length > 0"
                class="namedEntity__occurrences-occurrence"
                ng-repeat="occurrence in ::vm.occurrences"
                ng-click="vm.goToOccurrence(occurrence)">
                {{ ::occurrence.docLabel }} - Fol. {{ ::occurrence.pageLabel }} 
            </span>
            <span class="italic" ng-if="!vm.occurrences || (vm.occurrences && vm.occurrences.length <= 0)">
                No result found.
            </span>
        </span>
    </span>
</span>